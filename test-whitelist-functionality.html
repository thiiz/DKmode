<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Whitelist Functionality Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background-color: #ffffff;
      color: #000000;
    }

    h1 {
      color: #333;
      border-bottom: 2px solid #007bff;
      padding-bottom: 10px;
    }

    .test-section {
      margin: 30px 0;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
    }

    .test-section h2 {
      color: #007bff;
      margin-top: 0;
    }

    .test-step {
      margin: 15px 0;
      padding: 10px;
      background-color: white;
      border-left: 3px solid #28a745;
    }

    .test-step h3 {
      margin: 0 0 10px 0;
      color: #28a745;
      font-size: 16px;
    }

    .test-step ol {
      margin: 10px 0;
      padding-left: 20px;
    }

    .test-step li {
      margin: 5px 0;
    }

    .expected {
      background-color: #e7f3ff;
      padding: 10px;
      border-radius: 3px;
      margin-top: 10px;
    }

    .expected strong {
      color: #0056b3;
    }

    .note {
      background-color: #fff3cd;
      border-left: 3px solid #ffc107;
      padding: 10px;
      margin: 15px 0;
    }

    .note strong {
      color: #856404;
    }

    input[type="text"] {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 3px;
      width: 300px;
    }

    button {
      padding: 8px 16px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    .content-box {
      padding: 20px;
      margin: 20px 0;
      background-color: white;
      border: 2px solid #007bff;
      border-radius: 5px;
    }

    .content-box p {
      line-height: 1.6;
    }
  </style>
</head>

<body>
  <h1>ðŸ§ª Whitelist Functionality Test Page</h1>

  <div class="note">
    <strong>Note:</strong> This page is designed to test the whitelist functionality of the Dark Theme Extension.
    Follow the test steps below to verify that adding and removing sites from the whitelist works correctly.
  </div>

  <div class="test-section">
    <h2>Test 1: Add Current Site to Whitelist</h2>
    <div class="test-step">
      <h3>Steps:</h3>
      <ol>
        <li>Open the extension popup on this page</li>
        <li>Ensure global dark theme is <strong>disabled</strong></li>
        <li>In the Whitelist section, add the current site hostname</li>
        <li>Click "Add" button</li>
      </ol>
      <div class="expected">
        <strong>Expected Result:</strong>
        <ul>
          <li>Dark theme should apply immediately to this page</li>
          <li>Success message: "[hostname] added to whitelist and dark theme applied"</li>
          <li>Site appears in the whitelist with "(current)" badge</li>
          <li>Page background becomes dark, text becomes light</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Test 2: Add Different Site to Whitelist</h2>
    <div class="test-step">
      <h3>Steps:</h3>
      <ol>
        <li>Open the extension popup</li>
        <li>Add a different site (e.g., "example.com") to whitelist</li>
        <li>Click "Add" button</li>
      </ol>
      <div class="expected">
        <strong>Expected Result:</strong>
        <ul>
          <li>Success message: "example.com added to whitelist"</li>
          <li>Site appears in the whitelist</li>
          <li>Current page theme should NOT change</li>
          <li>Navigate to example.com to verify theme applies there</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Test 3: Remove Current Site from Whitelist (Global Theme Off)</h2>
    <div class="test-step">
      <h3>Steps:</h3>
      <ol>
        <li>Ensure current site is in whitelist and dark theme is active</li>
        <li>Ensure global dark theme toggle is <strong>OFF</strong></li>
        <li>Click "Remove" button next to current site in whitelist</li>
      </ol>
      <div class="expected">
        <strong>Expected Result:</strong>
        <ul>
          <li>Dark theme should be removed immediately from this page</li>
          <li>Success message: "[hostname] removed from whitelist and dark theme disabled"</li>
          <li>Site is removed from whitelist</li>
          <li>Page returns to normal light colors</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Test 4: Remove Current Site from Whitelist (Global Theme On)</h2>
    <div class="test-step">
      <h3>Steps:</h3>
      <ol>
        <li>Enable global dark theme toggle</li>
        <li>Add current site to whitelist</li>
        <li>Click "Remove" button next to current site in whitelist</li>
      </ol>
      <div class="expected">
        <strong>Expected Result:</strong>
        <ul>
          <li>Dark theme should REMAIN active (due to global setting)</li>
          <li>Success message: "[hostname] removed from whitelist"</li>
          <li>Site is removed from whitelist</li>
          <li>Page stays dark because global theme is enabled</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Test 5: Persistence Test</h2>
    <div class="test-step">
      <h3>Steps:</h3>
      <ol>
        <li>Add 2-3 sites to the whitelist</li>
        <li>Close the popup</li>
        <li>Reopen the popup</li>
        <li>Check the whitelist section</li>
      </ol>
      <div class="expected">
        <strong>Expected Result:</strong>
        <ul>
          <li>All added sites should still be in the whitelist</li>
          <li>Settings persist across popup open/close</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="test-section">
    <h2>Test 6: Error Handling on Restricted Pages</h2>
    <div class="test-step">
      <h3>Steps:</h3>
      <ol>
        <li>Navigate to a Chrome settings page (chrome://settings/)</li>
        <li>Open the extension popup</li>
        <li>Try to add the current site to whitelist</li>
      </ol>
      <div class="expected">
        <strong>Expected Result:</strong>
        <ul>
          <li>Error message: "Cannot apply theme to this page type."</li>
          <li>Whitelist is not updated</li>
          <li>No theme changes occur</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="content-box">
    <h2>Sample Content for Visual Testing</h2>
    <p>
      This is sample text content to help you verify that the dark theme is being applied correctly.
      When dark theme is active, this text should be light colored on a dark background.
    </p>
    <p>
      <strong>Bold text</strong> and <em>italic text</em> should also be styled appropriately.
    </p>
    <p>
      <a href="#test">This is a link</a> that should be styled with the dark theme link color.
    </p>
    <div>
      <input type="text" placeholder="Test input field" />
      <button>Test Button</button>
    </div>
  </div>

  <div class="note">
    <strong>Quick Reference:</strong>
    <ul>
      <li><strong>Whitelist:</strong> Sites that ALWAYS get dark theme (overrides global setting)</li>
      <li><strong>Priority:</strong> Blacklist > Whitelist > Site-specific > Global setting</li>
      <li><strong>Current Site Badge:</strong> Shows "(current)" next to the active site in lists</li>
    </ul>
  </div>

  <script>
    // Add some interactivity to help with testing
    document.addEventListener('DOMContentLoaded', () => {
      console.log('Test page loaded');
      console.log('Current hostname:', window.location.hostname);

      // Log when dark theme class is added/removed
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          if (mutation.attributeName === 'class') {
            const isDark = document.documentElement.classList.contains('dark-theme-active');
            console.log('Dark theme active:', isDark);
            if (isDark) {
              const intensity = document.documentElement.style.getPropertyValue('--dark-theme-intensity');
              console.log('Theme intensity:', intensity);
            }
          }
        });
      });

      observer.observe(document.documentElement, {
        attributes: true,
        attributeFilter: ['class', 'style']
      });
    });
  </script>
</body>

</html>